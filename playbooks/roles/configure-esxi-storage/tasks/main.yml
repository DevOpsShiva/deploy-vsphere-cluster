- name: Check datastores
  raw: esxcli storage nfs list | grep NFS-SSD
  ignore_errors: yes
  register: nfs_ssd_status

- name: Add NFS datastore (NFS-SSD)
  raw: esxcli storage nfs add --host="{{ nfs_storage }}" --share=/mnt/nfs-ssd --volume-name=NFS-SSD
  when: nfs_ssd_status.stdout.find("NFS-SSD") != 0

- name: Check datastores
  raw: esxcli storage nfs list | grep NFS-SATA
  ignore_errors: yes
  register: nfs_sata_status

- name: Add NFS datastore (NFS-SATA)
  raw: esxcli storage nfs add --host="{{ nfs_storage }}" --share=/mnt/nfs-sata --volume-name=NFS-SATA
  when: nfs_sata_status.stdout.find("NFS-SATA") != 0

- name: Check datastore list
  raw: esxcli storage nfs list
  register: datastore_list

- name: Review settings
  debug: var=datastore_list.stdout_lines


